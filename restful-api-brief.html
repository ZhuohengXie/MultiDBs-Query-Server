<html>
<head>
	<title>Restful API Documentation</title>
</head>
<bodystyle="background-color:HoneyDew">
<p>
<h2 style="color:brown">Restful api documentation</h2></br>
</p>

<h3>1.query</h3>

<p style="color:chocolate">description:</p>
<p>
Accepts a sql query string (like select ... from databaseid.tablename), and then returns the result content.</p>
<p style="color:chocolate">url:</p>
<p>http://54.174.80.167:7654/Query/
</p>
<p style="color:chocolate">request:</p>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">request-type:</font> PUT</br>
<font style="color:blue">request-json-format:</font></br>
<p style="color:DeepSkyBlue">
{"query":"your query string here"}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-query String</br>
</p>
</br>
<p style="color:chocolate">response:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">response-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
    "schema": {</br>
        "columnNames": ["column1", "column2", "column3"]</br>
    },</br>
    "data": [{</br>
        "row": ["value11", "value12", "value13"]</br>
    }]</br>
}</p></br>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-schema</br>
&nbsp&nbsp&nbsp&nbsp-columnNames (String[])</br>
&nbsp&nbsp-data  (row[])</br>
&nbsp&nbsp&nbsp&nbsp-row (String[])</br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.</br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.</br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.</br>
&nbsp&nbsp&nbsp&nbsp-row (String[])</br>
</p>
</br>
<p style="color:chocolate">error response:</p></br>
<font style="color:blue">response-json-format:</font></br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br>
</br>

<h3>2.get table content</h3>
<p style="color:chocolate">description:</p></br>
Accepts databseid and tableName as parameters, and then returns the table content.</br>
</br>
<p style="color:chocolate">url</p></br>
http://54.174.80.167:7654/Query/{databaseid}/{tablename}</br>
</br>
<p style="color:chocolate">request:</p></br>
<font style="color:blue">request-type:</font> GET</br>

<p style="color:chocolate">response: (same as above)</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">response-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
    "schema": {</br>
        "columnNames": ["column1", "column2", "column3"]</br>
    },</br>
    "data": [{</br>
        "row": ["value11", "value12", "value13"]</br>
    }]</br>
}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-schema</br>
&nbsp&nbsp&nbsp&nbsp-columnNames (String[])</br>
&nbsp&nbsp-data  (row[])</br>
&nbsp&nbsp&nbsp&nbsp-row (String[])</br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.</br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.</br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.</br>
&nbsp&nbsp&nbsp&nbsp-row (String[])</br>
</p>
<p style="color:chocolate">error response:</p></br>
<font style="color:blue">response-json-format:</font></br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br></br>
<h3>3. save query result as new datasource (debugging)</h3>
<p style="color:chocolate">description:</p></br>
With user input register information, it saves the query result as a new datasource. Will register on metastore and our matcher.
Only select queries can be saved.</br>
</br>
<p style="color:chocolate">url:</p></br>
http://54.174.80.167:7654/Query/Save/</br>
</br>
<p style="color:chocolate">request:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">request-type:</font> PUT</br>
<font style="color:blue">request-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
	"ip":"xxx.xxx.xxx.xxx",</br>
	"port":"pppp",</br>
	"dbtype":"MySQL",</br>
	"username":"your_username",</br>
	"password":"your_password",</br>
	"dbname":"database name",</br>
	"title":"title of the post",</br>
	"description":"description of the post",</br>
	"tablename":"your_table_name",</br>
	"query":"your query string here"</br>
}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-ip String</br>
&nbsp&nbsp-port String</br>
&nbsp&nbsp-dbtype String</br>
&nbsp&nbsp-username String</br>
&nbsp&nbsp-password String</br>
&nbsp&nbsp-dbname String</br>
&nbsp&nbsp-title String</br>
&nbsp&nbsp-description String</br>
&nbsp&nbsp-tablename String</br>
&nbsp&nbsp-query String</br>
</p>
<p style="color:chocolate">response:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">response-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
    "success": "the table has been saved"</br>
}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-success String("the table has been saved")</br>
    </p>
</br>
<p style="color:chocolate">error response:</p></br>
<font style="color:blue">response-json-format:</font></br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br></br>
<h3>4. add catalog (done, only open to metastore)</h3>
<p style="color:chocolate">description:</p></br>
With input information, it saves datasource connection as presto catalog, and did,catalog,databsename in matcher.</br>
</br>
<p style="color:chocolate">url:</p></br>
http://54.174.80.167:7654/Catalog/add</br>
</br>
<p style="color:chocolate">request:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">request-type:</font> PUT</br>
<font style="color:blue">request-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
	"id":"databaseid",</br>
	"ip":"xxx.xxx.xxx.xxx",</br>
	"port":"pppp",</br>
	"dbtype":"MySQL",</br>
	"username":"your username",</br>
	"password":"your password",</br>
	"dbname":"database name"</br>
}</p>
<p style="color:LightCoral">
-root</br>
&nbsp&nbsp-id String</br>
&nbsp&nbsp-ip String</br>
&nbsp&nbsp-port String</br>
&nbsp&nbsp-dbtype String</br>
&nbsp&nbsp-username String</br>
&nbsp&nbsp-password String</br>
&nbsp&nbsp-dbname String</br>
</p>
</br>
<p style="color:chocolate">response:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">response-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
    "success": "the record has been saved"</br>
}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-success String("the record has been saved")</br>
    </p>
</br>
<p style="color:chocolate">error response:</p></br>
<font style="color:blue">response-json-format:</font></br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br></br>
<h3>5. drop catalog (done, only open to metastore)</h3>
<p style="color:chocolate">description:</p></br>
Delete both the catalog file and the record in our matcher, where the database id is did.</br>
</br>
<p style="color:chocolate">url:</p></br>
http://54.174.80.167:7654/Catalog/drop/{did}</br>
</br>
<p style="color:chocolate">request: did is the database id</p>
<font style="color:blue">request-type:</font> GET</br></br>
<p style="color:chocolate">response:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">response-json-format:</font></br>
<p style="color:DeepSkyBlue">
{</br>
    "success": "the record has been deleted"</br>
}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-success String("the record has been deleted")</br>
    </p>
</br>
<p style="color:chocolate">error response:</p></br>
<font style="color:blue">response-json-format:</font></br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</body>
</html>
