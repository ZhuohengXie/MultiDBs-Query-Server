<html>
<head>
	<title>Restful API Documentation</title>
</head>
<bodystyle="background-color:HoneyDew">
<h3 style="color:brown">This is a brief restful api documentation of our presto query server  \^o^/</h3>

<h3>1.query</h3>

<p style="color:chocolate">description:</p>
<p>
Accepts a sql query string (like select ... from databaseid.tablename), and then returns the result content.</p>
<p style="color:chocolate">url:</p>
<p>http://54.174.80.167:7654/Query/
</p>
<p style="color:chocolate">request:</p>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">request-type:</font> PUT</br>
<font style="color:blue">request-json-format:</font></br>
</br>
<p style="color:DeepSkyBlue">
{"query":"your query string here"}</p>
<p style="color:LightCoral">
-(root)</br>
&nbsp&nbsp-query String</br>
</p>
</br>
<p style="color:chocolate">response:</p></br>
<font style="color:blue">content-type:</font>application/json</br>
<font style="color:blue">response-json-format:</font></br>
<p style="color:DeepSkyBlue'">
{</br>
    "schema": {</br>
        "columnNames": ["column1", "column2", "column3"]</br>
    },</br>
    "data": [{</br>
        "row": ["value11", "value12", "value13"]</br>
    }]</br>
}</p></br>
<p style="color:LightCoral">
-root</br>
  -schema</br>
    -columnNames (String[])</br>
  -data  (row[])</br>
    -row (String[])</br>
      .</br>
      .</br>
      .</br>
    -row (String[])</br>
</p>
</br>
<p style="color:chocolate">error response:</p></br>
response-json-format</br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br>
</br>

<h3>2.get table content</h3>
</br>
<p style="color:chocolate">description:</p></br>
Accepts databseid and tableName as parameters, and then returns the table content.</br>
</br>
<p style="color:chocolate">url</p></br>
http://54.174.80.167:7654/Query/{databaseid}/{tablename}</br>
</br>
<p style="color:chocolate">request:</p></br>
request-type: GET</br>
request-json-format:</br>
</br>
<p style="color:chocolate">response: (same as above)</p></br>
content-type: application/json</br>
response-json-format:</br>
{</br>
    "schema": {</br>
        "columnNames": ["column1", "column2", "column3"]</br>
    },</br>
    "data": [{</br>
        "row": ["value11", "value12", "value13"]</br>
    }]</br>
}</br>
-root</br>
  -schema</br>
    -columnNames (String[])</br>
  -data  (row[])</br>
    -row (String[])</br>
      .</br>
      .</br>
      .</br>
    -row (String[])</br>
</br>
<p style="color:chocolate">error response:</p></br>
response-json-format</br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br>
</br>
</br>
<h3>3. save query result as new datasource (debugging)</h3>
</br>
<p style="color:chocolate">description:</p></br>
With user input register information, it saves the query result as a new datasource. Will register on metastore and our matcher.
Only select queries can be saved.</br>
</br>
<p style="color:chocolate">url:</p></br>
http://54.174.80.167:7654/Query/Save/</br>
</br>
<p style="color:chocolate">request:</p></br>
content-type: application/json</br>
request-type: PUT</br>
request-json-format:</br>
{</br>
	"ip":"xxx.xxx.xxx.xxx",</br>
	"port":"pppp",</br>
	"dbtype":"MySQL",</br>
	"username":"your_username",</br>
	"password":"your_password",</br>
	"dbname":"database name",</br>
	"title":"title of the post",</br>
	"description":"description of the post",</br>
	"tablename":"your_table_name",</br>
	"query":"your query string here"</br>
}</br>
-root</br>
  -ip String</br>
  -port String</br>
  -dbtype String</br>
  -username String</br>
  -password String</br>
  -dbname String</br>
  -title String</br>
  -description String</br>
  -tablename String</br>
  -query String</br>
</br>
<p style="color:chocolate">response:</p></br>
content-type: application/json</br>
response-json-format:</br>
{</br>
    "success": "the table has been saved"</br>
}</br>
-root</br>
  -success String("the table has been saved")</br>
    </br>
</br>
<p style="color:chocolate">error response:</p></br>
response-json-format</br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br>
</br>
<h3>4. add catalog (done, only open to metastore)</h3>
</br>
<p style="color:chocolate">description:</p></br>
With input information, it saves datasource connection as presto catalog, and did,catalog,databsename in matcher.</br>
</br>
<p style="color:chocolate">url:</p></br>
http://54.174.80.167:7654/Catalog/add</br>
</br>
<p style="color:chocolate">request:</p></br>
content-type: application/json</br>
request-type: PUT</br>
request-json-format:  (may later extend dbtype to support hive, cassandra, etc.)</br>
{</br>
	"id":"databaseid",</br>
	"ip":"xxx.xxx.xxx.xxx",</br>
	"port":"pppp",</br>
	"dbtype":"MySQL",</br>
	"username":"your username",</br>
	"password":"your password",</br>
	"dbname":"database name"</br>
}</br>
-root</br>
  -id String</br>
  -ip String</br>
  -port String</br>
  -dbtype String</br>
  -username String</br>
  -password String</br>
  -dbname String</br>
</br>
</br>
<p style="color:chocolate">response:</p></br>
content-type: application/json</br>
response-json-format:</br>
{</br>
    "success": "the record has been saved"</br>
}</br>
-root</br>
  -success String("the record has been saved")</br>
    </br>
</br>
<p style="color:chocolate">error response:</p></br>
response-json-format</br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</br>
<h3>5. drop catalog (done, only open to metastore)</h3>
</br>
<p style="color:chocolate">description:</p></br>
Delete both the catalog file and the record in our matcher, where the database id is did.</br>
</br>
<p style="color:chocolate">url:</p></br>
http://54.174.80.167:7654/Catalog/drop/did</br>
</br>
<p style="color:chocolate">request: did is the database id</p></br>
request-type: GET</br>
</br>
<p style="color:chocolate">response:</p></br>
content-type: application/json</br>
response-json-format:</br>
{</br>
    "success": "the record has been deleted"</br>
}</br>
-root</br>
  -success String("the record has been deleted")</br>
    </br>
</br>
<p style="color:chocolate">error response:</p></br>
response-json-format</br>
{</br>
	"error" : "error type",</br>
	"message" : "description of error"</br>
}</br>
</body>
</html>
